{"ast":null,"code":"var _jsxFileName = \"/home/honey/Desktop/Frontend/ManagementPortal-FE/src/views/layout/Layout.view.js\";\nimport { get } from 'lodash';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport React, { Fragment, useEffect } from 'react';\nimport { withRouter, Redirect } from 'react-router-dom';\nimport AppRoutes from '../../AppRoutes';\nimport { getUser, refreshToken } from '../auth/auth.api';\nimport storage from '../../common/storage';\nimport { AUTH_ROUTES, USER_STATE } from '../../common/constants';\n\nconst Layout = ({\n  history,\n  location,\n  getUserFromApi,\n  isAuthenticated,\n  refreshToken,\n  user\n}) => {\n  useEffect(() => {\n    if (isAuthenticated && admin() && location && location.pathname) {\n      history.push(AUTH_ROUTES.includes(location.pathname) ? '/dashboard' : location.pathname);\n    } else if (isAuthenticated && employee() && location && location.pathname) {\n      history.push(AUTH_ROUTES.includes(location.pathname) ? '/employee' : '/employee');\n    } else if (!isAuthenticated && get(storage.get('user'), 'token')) {\n      getUserFromApi();\n    }\n\n    let interval;\n\n    if (storage.get('user')) {\n      interval = setInterval(() => {\n        refreshToken();\n      }, 60000);\n    }\n\n    return () => clearInterval(interval); // eslint-disable-next-line\n  }, [getUserFromApi, isAuthenticated, history]);\n\n  const admin = () => get(storage.get('user'), 'user.typeOfId') === USER_STATE.ADMIN_FULL;\n\n  const employee = () => get(storage.get('user'), 'user.typeOfId') === USER_STATE.EMPLOYEE;\n\n  console.log(user && user.user.typeofid);\n  return [React.createElement(Fragment, {\n    key: \"redirect\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, isAuthenticated && React.createElement(Redirect, {\n    to: AUTH_ROUTES.includes(location.pathname) ? '/dashboard' : location.pathname,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    key: \"app\",\n    id: \"app-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, React.createElement(AppRoutes, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }))];\n};\n\nLayout.defaultProps = {\n  isAuthenticated: false\n};\nLayout.propTypes = {\n  isAuthenticated: PropTypes.bool,\n  getUserFromApi: PropTypes.func,\n  history: PropTypes.object.isRequired,\n  location: PropTypes.object.isRequired,\n  refreshToken: PropTypes.func,\n  user: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  isAuthenticated: state.getIn(['auth', 'isAuthenticated']),\n  user: state.getIn(['auth', 'user'])\n});\n\nconst mapDispatchToProps = dispatch => ({\n  getUserFromApi: () => {\n    dispatch(getUser());\n  },\n  refreshToken: () => {\n    dispatch(refreshToken());\n  }\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Layout));","map":{"version":3,"sources":["/home/honey/Desktop/Frontend/ManagementPortal-FE/src/views/layout/Layout.view.js"],"names":["get","PropTypes","connect","React","Fragment","useEffect","withRouter","Redirect","AppRoutes","getUser","refreshToken","storage","AUTH_ROUTES","USER_STATE","Layout","history","location","getUserFromApi","isAuthenticated","user","admin","pathname","push","includes","employee","interval","setInterval","clearInterval","ADMIN_FULL","EMPLOYEE","console","log","typeofid","defaultProps","propTypes","bool","func","object","isRequired","mapStateToProps","state","getIn","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import { get } from 'lodash';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport React, { Fragment, useEffect } from 'react';\nimport { withRouter, Redirect } from 'react-router-dom';\n\nimport AppRoutes from '../../AppRoutes';\nimport { getUser, refreshToken } from '../auth/auth.api';\nimport storage from '../../common/storage';\nimport { AUTH_ROUTES, USER_STATE } from '../../common/constants';\n\nconst Layout = ({\n  history,\n  location,\n  getUserFromApi,\n  isAuthenticated,\n    refreshToken,\n    user,\n}) => {\n  useEffect(() => {\n    if (isAuthenticated && admin() && location && location.pathname) {\n      history.push(\n        AUTH_ROUTES.includes(location.pathname)\n          ? '/dashboard'\n          : location.pathname,\n      );\n    } else if (isAuthenticated && employee() && location && location.pathname) {\n      history.push(\n          AUTH_ROUTES.includes(location.pathname)\n              ? '/employee'\n              : '/employee',\n      );\n    }else if (!isAuthenticated && get(storage.get('user'), 'token')) {\n      getUserFromApi()\n    }\n    let interval;\n    if (storage.get('user')) {\n      interval = setInterval(() => {refreshToken()}, 60000);\n    }\n    return () => clearInterval(interval);\n    // eslint-disable-next-line\n  },[getUserFromApi, isAuthenticated, history]);\n\n  const admin = () => get(storage.get('user'), 'user.typeOfId') === USER_STATE.ADMIN_FULL;\n  const employee =() => get(storage.get('user'), 'user.typeOfId') === USER_STATE.EMPLOYEE;\n console.log(user && user.user.typeofid);\n  return [\n    <Fragment key=\"redirect\">\n      {isAuthenticated && (\n        <Redirect\n          to={\n            AUTH_ROUTES.includes(location.pathname)\n              ? '/dashboard'\n              : location.pathname\n          }\n        />\n      )}\n    </Fragment>,\n    <div key=\"app\" id=\"app-wrapper\">\n      <AppRoutes />\n    </div>,\n  ];\n};\n\nLayout.defaultProps = {\n  isAuthenticated: false,\n};\n\nLayout.propTypes = {\n  isAuthenticated: PropTypes.bool,\n  getUserFromApi: PropTypes.func,\n  history: PropTypes.object.isRequired,\n  location: PropTypes.object.isRequired,\n  refreshToken: PropTypes.func,\n  user: PropTypes.object,\n};\n\nconst mapStateToProps = (state) => ({\n  isAuthenticated: state.getIn(['auth', 'isAuthenticated']),\n  user: state.getIn(['auth', 'user' ])\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  getUserFromApi: () => {\n    dispatch(getUser());\n  },\n  refreshToken: () => {\n    dispatch(refreshToken());\n  },\n});\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Layout));\n"]},"metadata":{},"sourceType":"module"}